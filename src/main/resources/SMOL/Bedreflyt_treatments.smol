class TreatmentModel extends BaseModel()

    override Unit adaptAddition()
        List<Treatment> newTreatments = construct("
        PREFIX : <http://example.org/bedreflyt/>
        SELECT ?treatmentName ?diagnosis ?frequency ?weight
        WHERE {
            ?treatment a :Treatment ;
                :treatmentName ?treatmentName ;
                :frequency ?frequency ;
                :weight ?weight ;
                :isTreatmentProcOf ?diagnosisContent .
            ?diagnosisContent a :Diagnosis ;
                :diagnosisCode ?diagnosisCode .
            ?diagnosis a prog:Diagnosis ;
                prog:Diagnosis_diagnosisCode ?diagnosisCode .
        }");

        if newTreatments != null then
            print("RECONFIG> Adding new treatments...");

            while newTreatments != null do
                Treatment newTreatment = newTreatments.content;
                List<Treatment> lx = newTreatments;
                newTreatment.treatmentDiagnosis = newTreatment.getTreatmentDiagnosis();
                newTreatment.treatmentFrequency = newTreatment.getTreatmentFrequency();
                newTreatment.treatmentWeight = newTreatment.getTreatmentWeight();

                print("RECONFIG> Adding treatment " ++ newTreatment.treatmentName);
                destroy(lx);
            end
            print("RECONFIG> New treatments added");
        end
    end

    override Unit adaptRemoval()
        List<Treatment> wrongTreatments = access("
        PREFIX : <http://example.org/bedreflyt/>

        SELECT ?treatmentName ?diagnosis ?frequency ?weight
        WHERE {
            ?treatment a prog:Treatment ;
                prog:Treatment_treatmentName ?treatmentName ;
                prog:Treatment_frequency ?frequency ;
                prog:Treatment_weight ?weight ;
                prog:Treatment_isTreatmentProcOf ?diagnosisObj .
            ?diagnosisObj a prog:Diagnosis ;
                prog:Diagnosis_diagnosisCode ?diagnosisCode .
            FILTER NOT EXISTS {
                ?treatment a :Treatment ;
                    :treatmentName ?treatmentName ;
                    :frequency ?frequency ;
                    :weight ?weight ;
                    :isTreatmentProcOf ?diagnosisContent .
                ?diagnosisContent a :Diagnosis ;
                    :diagnosisCode ?diagnosisCode .
            }
        }");

        if wrongTreatments != null then
            print("RECONFIG> Removing wrong treatments...");

            while wrongTreatments != null do
                Treatment wrongTreatment = wrongTreatments.content;
                List<Treatment> lx = wrongTreatments;

                print("RECONFIG> Removing treatment " ++ wrongTreatment.treatmentName);
                destroy(wrongTreatment);
                destroy(lx);
            end

            destroy(wrongTreatments);
            print("RECONFIG> Wrong treatments removed");
        end
    end

    override Unit adaptDefect()
        // this.adaptDefectFrequency();
        // this.adaptDefectWeight();
        skip;
    end
end